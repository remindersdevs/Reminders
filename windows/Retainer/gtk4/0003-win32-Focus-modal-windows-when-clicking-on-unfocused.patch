From b3b207e121cf856f908347744ac1b3ba48526247 Mon Sep 17 00:00:00 2001
From: dgsasha <dgsasha04@gmail.com>
Date: Mon, 29 May 2023 20:13:25 -0400
Subject: [PATCH 3/4] win32: Focus modal windows when clicking on unfocused
 parent

---
 gdk/win32/gdkevents-win32.c | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/gdk/win32/gdkevents-win32.c b/gdk/win32/gdkevents-win32.c
index 10803a4845..54995313fa 100644
--- a/gdk/win32/gdkevents-win32.c
+++ b/gdk/win32/gdkevents-win32.c
@@ -2735,6 +2735,10 @@ gdk_event_translate (MSG *msg,
       if (GDK_IS_DRAG_SURFACE (window) ||
           _gdk_modal_blocked (window))
         {
+          /* Focus the modal window */
+          GdkSurface *modal_window = _gdk_modal_current ();
+          if (modal_window != NULL)
+            SetFocus (GDK_SURFACE_HWND (modal_window));
           *ret_valp = MA_NOACTIVATE;
           return_val = TRUE;
         }
@@ -2745,6 +2749,10 @@ gdk_event_translate (MSG *msg,
       if (GDK_IS_DRAG_SURFACE (window) ||
           _gdk_modal_blocked (window))
         {
+          /* Focus the modal window */
+          GdkSurface *modal_window = _gdk_modal_current ();
+          if (modal_window != NULL)
+            SetFocus (GDK_SURFACE_HWND (modal_window));
           *ret_valp = PA_NOACTIVATE;
           return_val = TRUE;
         }
-- 
2.33.0.windows.2

